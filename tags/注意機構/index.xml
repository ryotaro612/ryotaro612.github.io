<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>注意機構 on Blanket</title>
    <link>http://localhost:1313/tags/%E6%B3%A8%E6%84%8F%E6%A9%9F%E6%A7%8B/</link>
    <description>Recent content in 注意機構 on Blanket</description>
    <generator>Hugo</generator>
    <language>ja</language>
    <lastBuildDate>Mon, 29 Dec 2025 12:34:47 +0900</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/%E6%B3%A8%E6%84%8F%E6%A9%9F%E6%A7%8B/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>FLASHATTENTION: Fast and Memory-Efficient Exact Attention with IO-Awareness (2022)</title>
      <link>http://localhost:1313/posts/flashattention-fast-and-memory-efficient-exact-attention-with-io-awareness/</link>
      <pubDate>Mon, 29 Dec 2025 12:34:47 +0900</pubDate>
      <guid>http://localhost:1313/posts/flashattention-fast-and-memory-efficient-exact-attention-with-io-awareness/</guid>
      <description>&lt;p&gt;TransformerのQKV注意機構の時間、空間計算量は、系列長が\(N\)のときには\(O(N^2)\)になる。&#xA;&lt;a href=&#34;https://arxiv.org/pdf/2001.04451&#34;&gt;Reformer: The Efficient Transformer&lt;/a&gt;などのFLOP数を減らす手法はあるが、実際の処理時間を十分に短縮できず、普及していない。&#xA;&lt;a href=&#34;https://arxiv.org/pdf/2205.14135&#34;&gt;FLASHATTENTION&lt;/a&gt;は、FLOP数ではなく、GPUのHBM (high bandwidth memory) と SRAM間の転送量を減らし、処理時間を短縮する。&#xA;HBMの記憶領域はSRAMよりも数十倍大きいが、SRAMよりも数十倍遅い。&#xA;注意 $\mathbf{O}$ を計算するとき、FLASHATTENTIONは、$\mathbf{Q}$, $\mathbf{K}$, $\mathbf{V}$, $\mathbf{O}$それぞれの一部の行ベクトルからなるブロックだけをSRAMに読み、$\mathbf{O}$の一部を更新し、をHBMに書き込む。&#xA;ブロックの操作を繰り返すと、最終的に自己注意機構と等しい注意を計算できる。&lt;/p&gt;&#xA;&lt;p&gt;FLASHATTENTIONは、逆伝搬時のHBMとSRAM間の転送量も減らす。&#xA;通常のQKV注意機構であれば、$\mathbf{Q}$, $\mathbf{K}$, $\mathbf{V}$, $\mathbf{O}$の勾配を計算するためにSoftmax関数に与える行列$\mathbf{S}$とその結果$\mathbf{P}$を記録する。&#xA;$\mathbf{Q}$, $\mathbf{K}$, $\mathbf{V}$が\(\mathbb{R}^{N\times d}\)であれば、$\mathbf{S}$, $\mathbf{P}$のサイズは$\textrm{O}(N^2)$になる。&#xA;FLASHATTENTIONは、順伝搬時に計算した中間結果と$\mathbf{O}$から$\mathbf{S}$, $\mathbf{P}$を計算し直すことで、$\mathbf{S}$と$\mathbf{P}$の記録を省き、空間計算量を減らす。&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
