<!DOCTYPE html>
<html lang="en">

<head>
  
  
  <script>(function (w, d, s, l, i) {
      w[l] = w[l] || []; w[l].push({
        'gtm.start':
          new Date().getTime(), event: 'gtm.js'
      }); var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
          'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-W5TDG76');
  </script>
  
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=300,initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css"
    integrity="sha512-NmLkDIU1C/C88wi324HBc+S2kLhi08PN5GDeUVVVC/BVt/9Izdsc9SVeVfA1UZbY3sHUlDSyRXhCzHfr6hmPPw=="
    crossorigin="anonymous" />
  
  <link rel="stylesheet" href="https://ryotaro.dev/scss/base.min.d5f9c6d3a478082690f838fa06a179ccee4dea5bd3f0cb3f4a357e2803c48d33.css">
  
  <link rel="stylesheet" href="https://ryotaro.dev/scss/base.en.min.fabf7968ffbe5ff626ec9a346f0d38e91d0078974112f713b9d25782380a5073.css">
  

<link rel="stylesheet" href="https://ryotaro.dev/scss/single.min.8ed5cbfb3dc516e9c4459a65252e4e6e8e9026aabfa9eb9f602cf53b30754966.css">

<link rel="stylesheet" href="https://ryotaro.dev/scss/posts/single.min.0008713f3f7556e78c13cb8efde9cf534239cb206c10ba85ce5a76e6ae9ce758.css">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://kit.fontawesome.com/e48a1b5aa5.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css"
    integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
  
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"
    integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4"
    crossorigin="anonymous"></script>
  
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"
    integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
  <title>Consistent Hashing and Random Trees: Distributed Caching Protocols for Relieving Hot Spots on the World Wide Web</title>
</head>

<body>
  
  
  <noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W5TDG76" height="0" width="0"
      style="display:none;visibility:hidden" />
  </noscript>
  
  
  <header class="navigation">
    <h2><a href="https://ryotaro.dev/en/">Blanket</a></h2>
    <nav>
      <ul>
        <li><a href="https://ryotaro.dev/en/about">About</a></li>
        <li><a href="https://ryotaro.dev/en/posts">Posts</a></li>
        <li><a href="https://ryotaro.dev/en/tags">Tags</a></li>
        
        <li><a href="https://ryotaro.dev/posts/consistent-hashing-and-random-trees-distributed-caching-protocols-for-relieving-hot-spots-on-the-world-wide-web/">ja</a></li>
        
      </ul>
      <ul>
        
        <li>
          <a href="https://github.com/ryotaro612">
            <i class="fab fa-github"></i>
          </a>
        </li>
        
        
        <li>
          <a href="https://www.linkedin.com/in/ryotaro612/">
            <i class="fab fa-linkedin-in"></i>
          </a>
        </li>
        
        
        <li>
          <a href="https://speakerdeck.com/ryotaro612/">
            <i class="fa-brands fa-speaker-deck"></i>
          </a>
        </li>
        
        <li>
          <a href="https://ryotaro.dev/en/%20index.xml">
            <i class="fas fa-rss"></i>
          </a>
        </li>
        
      </ul>
    </nav>
  </header>
  
<main>
  <h1>Consistent Hashing and Random Trees: Distributed Caching Protocols for Relieving Hot Spots on the World Wide Web</h1>
  <ul class="tags">
    
    <li class="tag">
      <a href="https://ryotaro.dev/en/tags/consistent-hashing/">
	#Consistent Hashing
      </a>
    </li>
    
  </ul>  
  <span class="date">March 18, 2025</span>    
  <div>
    <p>Consistent hashing is used for load balancing in cache systems at the scale of a Content Delivery Network (CDN), as <a href="https://www.oreilly.com/library/view/designing-data-intensive-applications/9781491903063/">discussed</a>.
The paper <a href="https://dl.acm.org/doi/10.1145/258533.258660">Consistent Hashing and Random Trees: Distributed Caching Protocols for Relieving Hot Spots on the World Wide Web</a> proposed the hashing algorithm to decrease or eliminate the occurrence of hot spots in the network.</p>
<p>A Random Tree is a d-ary tree where consistent hashing maps each node to cache servers.
Assuming the root node&rsquo;s cache servers have all the pages, parent cache servers provide copies to their child nodes.
When a request for a page comes, a client chooses a leaf at random.
A leaf cache server that receives the request returns the page if the server stores it.
If the server does not store it, it recursively queries to its parent cache servers for the page.
When a cache miss occurs, the cache server increments a counter for the requested page.
If the counter exceeds a threshold, the cache server stores the page received from a parent cache server in addition to passing it to a child cache server.</p>
<p>Changes in the set of active cache servers are inevitable.
Additionally, clients and cache servers cannot communicate with all other cache servers.
To maintain the properties of the Random Tree and avoid unnecessary remapping, mapping definitions that minimize remappings due to chages in active servers are needed.</p>
<p>Consistent hashing in the Random Tree equally distributes cache servers among nodes and reduces the number of cache servers that need to be moved in response to changes in the set of active servers.
Consistent hashing uses a hash function to assign real numbers within the unit interval ([0, 1]) to cache servers and nodes.
It maps a node to the cache server whose value is nearest to that of the node&rsquo;s.
When a cache server joins, nodes from neighboring servers move to it if their values are closer to the new server than to their current server.</p>
<p>When a cache server leaves, nodes with real values greater than that of the removed server move to the successor, while those with smaller values move to the predecessor.
If the server with largest real value leaves, the server with the smallest value becomes the successor.</p>
<p>More precisely, the cache servers have some real numbers.
When a server joins or leaves, only nodes on the successor and predecessor are moved.
By assigning multiple real values to a cache server, consistent hashing can more evenly distribute the nodes from the leaving server to other servers, and it moves nodes to a new server from them.
A request consists of a client, a page, a path from a leaf to the root in the Random Tree, and the sequence of cache servers along the path.
The client determines the cache servers by applying consistent hashing to the path.</p>
<p>The paper describes an implementation of consistent hashing using a binary tree.
Other implementations of consistent hashing, such as <a href="https://arxiv.org/abs/1406.2294">A Fast, Minimal Memory, Consistent Hash Algorithm</a> and <a href="https://arxiv.org/abs/1505.00062">Multi-probe Consistent Hashing</a>, are also available.</p>
  </div>
</main>

  
<ul class="pagination">
    
    <li>
      <a href="/en/posts/coverage-is-not-strongly-correlated-with-test-suite-effectiveness/">
	<i class="fa-solid fa-xl fa-angle-left"></i>
      </a>
    </li>
    
    
    <li>
      <a href="/en/posts/language-models-are-few-shot-learners/">
	<i class="fa-solid fa-xl fa-angle-right"></i>
      </a>
    </li>
    
</ul>


  <footer>
    <small>Â© Ryotaro Nakamura. All Rights Reserved.</small>
  </footer>
</body>


</html>
